---
title: "Microsimulation - Household Carbon Tax in Argentina"
author: "Priscila Stitsman, Ines Dezcallar, David Gentili and Asad Azhar"
editor: visual
format:
  html:
    embed-resources: true
    code-fold: false
    toc: true
editor_options: 
  chunk_output_type: inline
execute:
  warning: false
---

# Microsimulation Model Proposal: Household-Level Carbon Tax in Argentina

## Objective

To evaluate the distributional impact and policy design trade-offs of implementing a household-level carbon tax in Argentina, using a microsimulation model based on household energy expenditure data and carbon pricing structures from Argentina and added policies from developed countries.

## Policy Context

### Rationale for Carbon Pricing

-   Carbon taxes are a cost-effective means of reducing emissions compared to command-and-control regulations or subsidies (Gugler et al., 2021).

-   As a Pigouvian tax, carbon pricing helps internalize the external costs of carbon emissions, creating incentives for households to adjust their energy consumption behavior toward cleaner alternatives.

### Current Carbon Tax Landscape in Argentina

-   Since 2017, Argentina has implemented a carbon tax (Ley N° 23.966), but:

    -   It applies upstream (to fuel importers and producers) and not directly to households.

    -   The tax structure is based on fixed amounts adjusted for inflation, currently equivalent to \~\$10/tCO2E.

    -   Tax rates are lower than Canada (\~\$50/tCO2E), though higher than regional peers (Chile, Colombia, Mexico).

    -   Multiple exemptions and policy shifts have weakened the intended impact (e.g., diesel and gasoil exemptions in 2018 and 2020).

### Lessons from Canada

-   Canada applies a higher and more uniform carbon price (\~\$50/tCO2E).

-   Provides direct lump-sum rebates to households based on family size, rural location, and province.

-   This model serves as a benchmark for balancing equity and efficiency in policy design.

## Microsimulation Model Structure

-   Use microdata from Argentina's national household expenditure survey (e.g., EPH, ENGHo) to estimate baseline household spending on energy sources

-   Apply carbon price increases to each energy source using the official carbon content conversion table (from Argentina's tax authority or IPCC guidelines).

-   Start with Argentina's current rates, and escalate to \$50/tCO2E to simulate the Canadian-equivalent carbon price.

-   Model price pass-through to consumers under the assumption that households ultimately bear the tax burden through higher energy prices.

### Heterogeneous Price Scenarios

-   Simulate different carbon price levels (e.g., \$10, \$25, \$50/tCO2E) to compare distributional effects under:

    -   A uniform price across all households.

    -   A differential price structure based on income quintiles (e.g., lower rates for the poor).

### Distributional Analysis

-   Estimate post-tax energy expenditures for each household
-   Estimate impact on income and income distribution
-   Estimate impact per income quintiles
-   Evaluate revenue recycling mechanisms through cash transfers:
    -   Flat per capita rebate (uniform transfer to all)
    -   Progressive rebate (Enhanced rebates for lower-income households, Higher transfers for rural areas (aligned with Canadian policy))
    -   Compare net distributional impacts: tax paid minus rebate received.

## Data processing

Uploading necessary packages

```{r}
library(readr)
library(here)
library(tidyverse)
```

```{r}
#####  Household - WE USE THIS FOR HOUSEHOLD INCOME
hh_2018 <- read_delim(here("data","engho2018_hogares.txt"),
  delim = "|",
  col_names = FALSE,
  locale = locale(encoding = "Latin1")
)

colnames(hh_2018) <- strsplit(
  "id.provincia.region.subregion.trimestre.anio.pondera.cv1c04.cv1c05_a.cv1c05_b.cv1c05_c.cv1c05_d.cv1c06_e.cv1c06_f.cv1c07.cv1c08.cv1c09.cv1c10.cv1c11.cv1c12.cv1c13.ch01.ch02.ch03.ch04.ch05.ch06.ch07.ch08.ch09.ch10.ch11.ch12.ch13.ch14.ch15.ch16.ch17_a.ch17_b.ch18.ch19.ch20.ch21.propauto.regten.hacina.jniveled.jsexo.jedad_agrup.jsitconyugal.jdif_lp.jestado.jocupengh.jpercept.jcomed.tipohog.cantping.reldep.cantmiem.cantadequi.menor18.menor14.mayor65.dif_lph.cant_act.permieoc.clima_educativo.gastot.gastotpc.gasto_comunh.gascomp.gasvent.gc_01.gc_02.gc_03.gc_04.gc_05.gc_06.gc_07.gc_08.gc_09.gc_10.gc_11.gc_12.gc09_01.gc09_02.gc09_03.gc09_04.gc09_05.gc09_06.gc09_07.gc09_08.gc09_09.fp_contado.fp_credito.fp_especie.fp_prodprop.fp_tarjetas.fp_otras.fp_indef.tn_hipsup.tn_autoserv.tn_negesp.tn_restaurant.tn_kiosco.tn_internet.tn_comedor.tn_especie.tn_otros.tn_indef.decgaphp.decgaphr.decgapht.quigaphp.quigaphr.quigapht.gasto_imputado.m_gasto_imputado.ingtoth.ingpch.m_ingtoth.ingtoth_imp.qinth_p.qinth_r.qinth_t.dinth_p.dinth_r.dinth_t.qinpch_p.qinpch_r.qinpch_t.dinpch_p.dinpch_r.dinpch_t",
  "\\."
)[[1]]

# Count of missing values in each column
colSums(is.na(hh_2018))

# First rows as colnames
colnames(hh_2018) <- as.character(unlist(hh_2018[1, ]))
hh_2018 <- hh_2018[-1, ]
hh_2018 <- type.convert(hh_2018, as.is = TRUE)

##### Expenditures - WE USE THIS FOR HOUSEHOLD EXPENDITURE IN ENERGY

gastos <- read_delim((here("data",
                           "engho2018_gastos.txt")),
                     delim = "|",
                     locale = locale(encoding = "Latin1"))
##### Codebook

codes <- read_delim(here("data",
  "engho2018_articulos.txt"),
  delim = "|",
  locale = locale(encoding = "Latin1")
)
```

```{r}
########################################################
##### Energy expenditure: electricity, gas, others ##### 
########################################################


energy_exp <- gastos %>%
  filter(articulo %in% c("A0451101", "A0451102", "A0451103",
                         "A0452101", "A0452102", "A0452103", 
                         "A0452104", "A0452105", 
                         "A0453101", "A0453102", "A0453103")) %>%
  mutate(articulo_label = case_when(
    articulo == "A0451101" ~ "Electricidad - vivienda principal",
    articulo == "A0451102" ~ "Electricidad - vivienda secundaria",
    articulo == "A0451103" ~ "Gastos de electricidad realizados para una vivienda ocupada por otro hogar",
    articulo == "A0452101" ~ "Gas envasado en garrafas",
    articulo == "A0452102" ~ "Gas a granel",
    articulo == "A0452103" ~ "Gas natural - vivienda principal",
    articulo == "A0452104" ~ "Gas envasado en tubo",
    articulo == "A0452105" ~ "Gas natural - vivienda secundaria",
    articulo == "A0453101" ~ "Kerosene",
    articulo == "A0453102" ~ "Leña y carbón",
    articulo == "A0453103" ~ "Otros combustibles para el hogar",
    TRUE ~ "Otro"
  ))


###########################
##### Household Income ####
###########################

income_hh <- hh_2018 %>% select(id, ingtoth, ingpch)


## Join

carbon_tax <- energy_exp %>%
  left_join(income_hh %>% select(id, ingtoth), by = "id") %>%
  select (-miembro, -subclase, -clase, -grupo, -division, -forma_pago, -modo_adq, -lugar_adq, -tipo_negocio)


```

## Exploratory Analysis

```{r}
#Compute total energy spend & share of income per household
df_house <- carbon_tax %>%
  group_by(id, ingtoth) %>%
  summarize(
    total_energy = sum(monto),
    .groups = "drop"
  ) %>%
  mutate(
    energy_share = total_energy / ingtoth
  )

#Bring quintiles of income back in
df_house <- df_house %>%
  mutate(
    income_quintile = ntile(ingtoth, 5)
  )

#Merge article-level data back on, in case you need detailed per-fuel stats
df_detail <- carbon_tax %>%
  left_join(
    select(df_house, id, energy_share, income_quintile),
    by = "id"
  )

#We need to check the values where people spend over 100% of their income in energy
df_house <- df_house %>%
  filter(energy_share < 1)

```

### Distribution of energy expenditure as a share of income

```{r}
ggplot(df_house, aes(x = energy_share)) +
  geom_histogram(binwidth = 0.01, fill = "steelblue", alpha = 0.7) +
  geom_density(aes(y = ..count..*0.01), color = "black", size = 1) +
  scale_x_continuous(labels = scales::percent) +
  labs(
    x = "% of Income Spent on Energy",
    y = "Household Count",
    title = "Distribution of Energy Spending as % of Income"
  ) +
  theme_classic()
```

### Distribution of energy expenditure as a share of income by quintiles

```{r}
ggplot(df_house, aes(factor(income_quintile), energy_share)) +
  geom_boxplot() +
  scale_y_continuous(labels = scales::percent) +
  labs(
    x = "Income Quintile",
    y = "% Income",
    title = "Energy Share by Income Quintile"
  ) +
  theme_minimal()
```

### Income distribution

```{r}
ggplot(df_house, aes(x = ingtoth)) +
  geom_histogram(bins = 50, fill = "orchid", alpha = 0.6) +
  scale_x_log10(labels = scales::dollar) +
  labs(
    x = "Household Income (log scale)",
    y = "Count",
    title = "Income Distribution"
  ) +
  theme_minimal()
```

### Income spent by energy type x income quintile (Bar chart)

```{r}
fuel_quint <- df_detail %>%
  group_by(income_quintile, articulo_label) %>%
  summarize(
    mean_spend = mean(monto),
    .groups = "drop"
  )

ggplot(fuel_quint, aes(
  x = factor(income_quintile),
  y = mean_spend,
  fill = articulo_label
)) +
  geom_col(position = "dodge") +
  labs(
    x = "Income Quintile",
    y = "Avg Spend (local currency)",
    fill = "Energy Source",
    title = "Average Spend on Each Energy Type by Income Quintile"
  ) +
  theme_minimal()
```

### Income spent by energy type x income quintile (Facet)

```{r}
ggplot(fuel_quint, aes(x = factor(income_quintile), y = mean_spend)) +
  geom_col(fill = "skyblue") +
  facet_wrap(~ articulo_label) +
  labs(
    x = "Income Quintile",
    y = "Avg Spend",
    title = "Spend on Each Energy Source by Quintile"
  ) +
  theme_minimal()
```

### Total spent on each energy source

```{r}
totals <- carbon_tax %>%
  group_by(articulo_label) %>%
  summarize(total_spend = sum(monto), .groups = "drop")

ggplot(totals, aes(x = reorder(articulo_label, total_spend), y = total_spend)) +
  geom_col(fill = "goldenrod") +
  coord_flip() +
  labs(
    x = "Energy Source",
    y = "Total Spend",
    title = "Total Household Spend by Energy Source"
  ) +
  theme_minimal()
```
